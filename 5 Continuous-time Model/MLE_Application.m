rate=readtable("FRB_H15.csv");
X = table2array(rate(:,1));
lkh=@(sigma)-L(X,sigma);
[MLE,fval,~,~,~,hessian]=fminunc(lkh,[1,1,2,1/250,1]);
%MLE = [1.0696,1.3072,1.7791,0.0250,2.0226]
fval_of_L=-fval;
%fval_of_L=-0.1375
hessian_of_L=inv(-(-hessian)/length(X));
ssbeta=hessian_of_L(1,1);
z_beta=MLE(1)/sqrt(ssbeta/length(X));
p_beta=2*(1-normcdf(abs(z_beta)));
std_beta=sqrt(ssbeta/length(X));
%std_beta=15.8319
%p_beta=0.9461
ssalpha=hessian_of_L(2,2);
z_alpha=MLE(2)/sqrt(ssalpha/length(X));
p_alpha=2*(1-normcdf(abs(z_alpha)));
std_alpha=sqrt(ssalpha/length(X));
%std_alpha=67.0583
%p_alpha=0.9844
sssigma=hessian_of_L(3,3);
z_sigma=MLE(3)/sqrt(sssigma/length(X));
p_sigma=2*(1-normcdf(abs(z_sigma)));
std_sigma=sqrt(sssigma/length(X));
%std_sigma=0+12.7991i
%p_sigma=0.8894

X1 = X(1:26);
lkh=@(sigma)-L(X1,sigma);
[MLE,fval,~,~,~,hessian]=fminunc(lkh,[1,1,2,1/250,1]);
%MLE = [1.0606,1.1760,1.7744,0.0067,1.7785]
fval_of_L=-fval;
%fval_of_L=0.5118
hessian_of_L=inv(-(-hessian)/length(X1));
ssbeta=hessian_of_L(1,1);
z_beta=MLE(1)/sqrt(ssbeta/length(X1));
p_beta=2*(1-normcdf(abs(z_beta)));
std_beta=sqrt(ssbeta/length(X));
%p_beta=0.9754
ssalpha=hessian_of_L(2,2);
z_alpha=MLE(2)/sqrt(ssalpha/length(X1));
p_alpha=2*(1-normcdf(abs(z_alpha)));
std_alpha=sqrt(ssalpha/length(X));
%p_alpha=0.9811
sssigma=hessian_of_L(3,3);
z_sigma=MLE(3)/sqrt(sssigma/length(X1));
p_sigma=2*(1-normcdf(abs(z_sigma)));
std_sigma=sqrt(sssigma/length(X));
%p_sigma=0.7884

X2 = X(27:51);
lkh=@(sigma)-L(X2,sigma);
[MLE,fval,~,~,~,hessian]=fminunc(lkh,[1,1,2,1/250,1]);
%MLE = [1.2207,1.4833,1.45985939996535,0.0113,2.2529]
fval_of_L=-fval;
%fval_of_L=0.4530
hessian_of_L=inv(-(-hessian)/length(X2));
ssbeta=hessian_of_L(1,1);
z_beta=MLE(1)/sqrt(ssbeta/length(X2));
p_beta=2*(1-normcdf(abs(z_beta)));
%p_beta=9783
ssalpha=hessian_of_L(2,2);
z_alpha=MLE(2)/sqrt(ssalpha/length(X2));
p_alpha=2*(1-normcdf(abs(z_alpha)));
%p_alpha=0.9658
sssigma=hessian_of_L(3,3);
z_sigma=MLE(3)/sqrt(sssigma/length(X2));
p_sigma=2*(1-normcdf(abs(z_sigma)));
%p_sigma=0.8408